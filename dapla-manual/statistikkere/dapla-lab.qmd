---
title: Dapla Lab
date-modified: 01/28/2025
lightbox: true
---


**Dapla Lab** er SSBs arbeidsbenk for statistikkproduksjon og forskning. L√∏sningen er bygget p√• [INSEE](https://www.insee.fr/en/) sin plattform [Onyxia](https://www.onyxia.sh/). Form√•let med Dapla Lab er √• kunne tilby moderne skybaserte dataverkt√∏y til SSB-ere p√• en effektiv og enhetlig m√•te. Dapla Lab gir brukeren en enkel oversikt over hvilke verkt√∏y som tilbys, b√•de internt utviklet programvare og velkjente open-source verkt√∏y. Alle tjenestene kan konfigureres etter brukerens √∏nsker.


## Innlogging

Alle som er p√• SSBs nettverk kan logge seg inn i Dapla ved √• g√• inn p√• nettadressen <https://lab.dapla.ssb.no/> og velge **Logg inn** √∏verst i h√∏yre hj√∏rne. @fig-dapla-lab-landing viser landingssiden som m√∏ter brukeren.

![Landingsside for Dapla Lab](../images/dapla-lab-landing.png){fig-alt="Alternativtekst" #fig-dapla-lab-landing}

## Funksjonalitet

:::: {.columns}

::: {.column width="75%"}

Selv om Dapla Lab er en l√∏sning for √• tilby tjenester s√• er det ogs√• en del nyttig funksjonalitet Dapla Lab. @fig-dapla-lab-menu viser menyen i Dapla Lab som gir en oversikt over funksjonaliteten som finnes. Under beskriver vi n√¶rmere hvordan man blant annet kan:

- definere brukernavn og e-post for Git 
- lagre GitHub-token
- lagre tjenestekonfigurasjon
- f√• oversikt over hvilke tjenester man har kj√∏rende
- pause en tjeneste

Menyen i @fig-dapla-lab-menu inkluderer ogs√• lenker til andre nettsteder som er nyttig n√•r man jobber med data p√• Dapla. Meny-innslagene **Dapla Manualen**, **Dapla Ctrl**, **Google Cloud Console** og **FAQ** er alle lenker til eksterne ressurser.  

:::

::: {.column width="5%"}
<!-- empty column to create gap -->
:::

::: {.column width="20%"}

![Menyen i Dapla Lab](../images/dapla-lab-menu.png){fig-alt="Alternativtekst" #fig-dapla-lab-menu}

:::

::::

### Hjem

**Hjem** tar deg til landingssiden i Dapla Lab, slik som vist i @fig-dapla-lab-landing. Her finner du nyttige lenker til l√¶ringsressurser for Dapla, felleskap p√• Viva Engage og [opprettelse av Dapla-team](./dapla-ctrl.html#opprette-team). 

### Min konto

N√•r man logger seg inn i Dapla Lab s√• skjer det SSB-kontoen til brukeren. Under **Min konto** kan man se informasjon om sin konto og konfigurere noen nyttige verdier knyttet til brukeren din.

#### Kontoinformasjon

Under denne fanen kan lese ut hvilken bruker-id som er benyttet for innloggingen i Dapla Lab, ditt fulle navn og e-postadresse i Dapla Lab. Informasjonen blir definert ved innlogging og kan ikke endres i Dapla Lab.  

![Kontoinformasjon under Min konto i Dapla Lab](../images/dapla-lab-kontoinfo.png){fig-alt="Viser fanen for kontoinformasjon under menyen Min konto" #fig-dapla-lab-kontoinfo}

#### Git

Under fanen **Git** kan man definere brukernavn og e-post for Git, og et personlig tilgangstoken for GitHub. Dette vil deretter kunne brukes i tjenester som brukeren starter i Dapla Lab.

![Git-konfigurasjon under Min konto i Dapla Lab](../images/dapla-lab-git.png){fig-alt="Viser fanen for Git-informasjon under menyen Min konto" #fig-dapla-lab-git}

#### Grensesnittpreferanser

Under fanen **Grensesnittpreferanser** kan man tilpasse Dapla Lab til sine preferanser ved √• velge om man blant annet √∏nsker **Dark mode** eller ikke. I tillegg kan man definere hvilket spr√•k man √∏nsker i Dapla Lab. Det finnes ogs√• avanserte valg for avanserte brukere. F.eks. man √∏nsker √• se hvilke Helm-kommandoer som kj√∏res i bakgrunnen n√•r man starter en tjeneste. 

![Grensesnittpreferanser under Min konto i Dapla Lab](../images/dapla-lab-grensesnitt.png){fig-alt="Viser fanen for grensesnittpreferasner under menyen Min konto" #fig-dapla-lab-grensesnitt}

### Tjenestekatalog

Under **Tjenestekatalogen** ligger alle tjenestene som brukeren kan velge √• starte.

![Tjenestekatalogen i Dapla Lab](../images/dapla-lab-tjenestekat.png){fig-alt="Viser tjenestekatalogen i Dapla Lab." #fig-dapla-lab-tjenestekat}

@fig-dapla-lab-tjenestekat viser hvilke tjenester som n√• er tilgjengelig i Dapla Lab, inkludert en kort beskrivelse av bruksomr√•det for hver tjeneste. @fig-dapla-lab-tjenestekonf viser hva som m√∏ter n√•r de starter **Jupyter**-tjenesten.

### Tjenestekonfigurasjon

Alle tjenester p√• Dapla Lab kan konfigureres f√∏r de startes opp. Trykker man p√• **Start** p√• en av tjenestene i [tjenestekatalogen](./dapla-lab.qmd#tjenestekatalog) kommer man inn tjenestekonfigurasjon for akkurat den tjenesten. Felles for alle tjenester er at man kan navngi hver tjeneste og velge versjon^[Det er sjelden behov for √• brukere √• endre versjon her.], slik som vist under **Vennlig navn** og **Versjon** i @fig-dapla-lab-tjenestekonf.

![Tjenestekonfigurasjon i Dapla Lab](../images/dapla-lab-tjenestekonf.png){fig-alt="Viser tjenestekatalogen i Dapla Lab." #fig-dapla-lab-tjenestekonf}

Ekspanderer man **Jupyter konfigurasjoner** vist i @fig-dapla-lab-tjenestekonf, s√• f√•r man opp konfigurasjon som er spesifikk for akkurat den tjeneste. Hver tjenestetilbyder vurderer hvilken konfigurasjon som gir mening for den tjenesten de tilbyr. 

For programmeringsmilj√∏er som [Jupyter](./jupyter.qmd) og [VS Code](./vscode-python.qmd) kan brukeren velge hvilket team og tilgangsgruppe de skal representere, hvor mye ram og gpu de √∏nsker, hvor stor diskplass de √∏nsker, Git/GitHub-oppsett, etc.. 

I [Datadoc](./datadoc.qmd)-tjenesten har tilbyderen kun valgt √• la brukeren velge hvilket team de representerer og versjon av tjenesten. Les mer om tjenestekonfigurasjonen til en tjeneste i dokumentasjonen til tjenesten.  

#### Lagre tjenestekonfigurasjon

Vanligvis vil brukeren √∏nske √• starte en tjeneste med samme konfigurasjon som sist. Dapla Lab tilbyr derfor at du kan lagre en tjenestekonfigurasjon med egenvalgt navn. Etter at du har valgt verdiene du √∏nsker i tjenestekonfigurasjonen s√• trykker du p√• **Lagre**-ikonet vist i @fig-dapla-lab-tjenestekonf. Deretter kan du se dine lagrede konfigurasjoner under **Mine tjenester**, slik som vist i @fig-dapla-lab-tjenestekonf-lagret.

![Tjenestekonfigurasjon i Dapla Lab](../images/dapla-lab-tjenestekonf-lagret.png){fig-alt="Lagrede tjenestekonfigurasjoner i Dapla Lab." #fig-dapla-lab-tjenestekonf-lagret}

#### Dele tjenestekonfigurasjon

Man kan ogs√• dele sin tjenestekonfigurasjon med andre i SSB. Det forutsetter at de man deler med har de samme datatilgangene som den som deler. Man kan dele lagrede tjenestekonfigurasjoner ved √• g√• til **Mine tjenester**, trykke p√• de tre prikkene til h√∏yre i tjenesten i ikonet, og deretter **Kopier URL-lenke**, slik som vist i @fig-dapla-lab-tjenestekonf-share. Deretter er det bare √• sende lenken til en kollega, og de kan √•pne en likt konfigurert tjeneste med sine tilganger.  

![Dele lagret tjenestekonfigurasjon i Dapla Lab](../images/dapla-lab-tjenestekonf-share.png){fig-alt="Lagrede tjenestekonfigurasjoner i Dapla Lab." #fig-dapla-lab-tjenestekonf-share}

::: {.callout-warning}
## Noe konfigurasjon kan ikke deles

Konfigurasjon som er knyttet [brukerkonfigurasjon](./dapla-lab.qmd#min-konto) fra Dapla Lab, f.eks. GitHub-token, m√• settes manuelt av den man deler konfigurasjon med. Dette vil forh√•pentligvis forbedres etter hvert.  
:::


### Mine tjenester

Under **Mine tjenester** f√•r man oversikt over hvilke tjenester som er startet av brukeren. @fig-dapla-lab-mine-tjenester viser en bruker som har 3 tjenester kj√∏rende. Her f√•r man informasjon om hvilken tjeneste som er starter, hvor lenge den har kj√∏rt, og muligheten til √• pause eller avslutte tjenesten.

![Oversikt over brukerens kj√∏rende tjenester](../images/dapla-lab-mine-tjenester.png){fig-alt="Alternativtekst" #fig-dapla-lab-mine-tjenester}

Hvis man trykker p√• s√∏ppelkasse-ikonet s√• avsluttes tjenesten og alt som er lagret inne i tjenesten blir slettet. Hvis man trykker p√• pause-knappen s√• bevares alt som brukeren har lagret under `$HOME/work`, mens alt annet blir slettet. 

::: {.callout-important}
## Viktigheten av √• avslutte ubrukte tjenester

En tjeneste som st√•r som aktiv vil reservere ressursene (CPU, GPU, RAM, etc.) som brukeren valgte ved oppstart. Hvis tjenesten ikke benyttes b√∏r derfor brukeren enten avslutte eller pause tjenesten, slik at SSB ikke m√• betale for ubrukte ressurser.
:::

### Monitorering

::: {.callout-warning}
## All monitorering er ikke p√• plass enda

Innholdet p√• Overv√•kningssiden til tjenestene er fullstendig enda. N√•r du kommer inn p√• siden s√• skal loggene fra tjenesten viser, men dette er ikke p√• plass enda. Dette jobbes det med √• f√• p√• plass. 

Derimot fungerer **Ekstern overv√•kning**-lenken (se beskrivelse under) og den tar deg til et Grafana-dashboard som viser vanlige metrikker for tjenesten. I tillegg kan man trykke p√• lenken **Helm-verdier** som teknisk informasjon om hvilke verdier som ble satt n√•r tjenesten ble startet.     
:::


Under **Mine tjenester** f√•r du oversikt over hvilke kj√∏rende tjenester. Hvis du √∏nsker √• monitorere hvor mye ram, cpu diskplass eller gpu tjenester bruker, s√• kan du inspisere et ferdig oppsatt Grafana-dashboard. For √•pne dashboardet trykker du f√∏rst p√• navnet p√• tjenesten du √∏nsker √• monitorere, slik som vist i @fig-monitoring-button. Det √•pner en side for Overv√•kning av tjenesten. P√• denne siden er det en lenke til et Grafana-dashboard, slik som vist i @fig-monitoring-button2.  

::: {#fig-elephants layout-ncol=2}

![√Öpne Overv√•kningssiden](../images/dapla-lab-monitoring.png){#fig-monitoring-button}

![√Öpne Grafana-dashboard](../images/dapla-lab-grafana-button.png){#fig-monitoring-button2}

√Öpne Grafana-dashboard for for kj√∏rende tjenester
:::

@fig-dapla-lab-grafana-dashboard viser hvordan et Grafana-dashboard ser ut.

![Grafana dashbaordet for en spesifikk tjeneste p√• Dapla Lab](../images/dapla-lab-grafana-dashboard.png){fig-alt="Alternativtekst" #fig-dapla-lab-grafana-dashboard}

## Datatilgang

Brukere som skal ha tilgang til data fra en tjeneste m√• f√∏rst oppgi hvilket team og tilgangsgruppe^[Hvis en bruker er medlem i b√•de *data-admins*- og *developers*-gruppa til et team, s√• m√• de velge hvilken av de to gruppene de skal representere i tjenesten som startes.] de skal representere. Siden brukere ofte er medlem av flere team, s√• er dette et viktig sikkerhetstiltak for √• sikre at data ikke kobles p√• tvers av team uten at dette er godkjent av data-ansvarlige.

For √• f√• tilgang til lagringsb√∏ttene i prod-prosjektet til et team, s√• m√• man logge seg inn i prod-milj√∏et til Dapla Lab (<https://lab.dapla.ssb.no/>). Skal man ha tilgang til lagringsb√∏ttene i test-prosjektet til et team m√• man logge seg inn i test-milj√∏et til Dapla Lab (<https://lab.dapla-test.ssb.no/>). For team som har er et dev-milj√∏ s√• gjelder f√∏lgende dev-milj√∏et til Dapla Lab (<https://lab.dapla-test.ssb.no/>).

### B√∏tter som filsystem

Tjenestene i Dapla Lab gj√∏r teamets b√∏tter tilgjengelig som mapper i filsystemet i tjenesten. Det vil si at man kan referere til data som man er vant til p√• vanlige filsystem, og man kan bruke biblioteker uten √• autentisere seg mot b√∏tter. 

Alle tjenester som tilgjengeliggj√∏r data fra b√∏tter monterer filsystemet p√• stien `/buckets/`. Videre representeres b√∏ttene ved sitt kortnavn. F.eks. vil b√∏ttestien `gs://ssb-dapla-felles-data-produkt-prod/` representeres som `/buckets/produkt/` i tjenesten. 

### Jobbe med data

Siden Dapla Lab tilbyr √• tilgjengliggj√∏re lagringsb√∏tter som filsystem inne i tjenesten, s√• finnes det n√• to m√•ter √• aksessere data p√•: 

1. Bruke *vanlige pakker* som Pandas, Polars, Pyarrow, etc. mot filsystemet under `/buckets/`.
2. Den "gamle" m√•ten med [dapla-toolbelt](./jobbe-med-data.qmd#dapla-toolbelt) som er et overbygg over Pandas og Pyarrow^[dapla-toolbelt er en pakke som ble bygget som et overbygg over Pandas og Pyarrow slik at det ble lettere √• lese/skrive mot b√∏tter. Med b√∏tter som filsystem inne i tjenestene er ikke dette lenger n√∏dvendig.].

Det er anbefalt at alle benytter seg av alternativ 1 siden det er enklere for de fleste og gj√∏r at alle medlemmer av et team kan se hverandres endringer n√•r man jobber mot samme b√∏tte (se boks under). 

::: {.callout-caution}
## Eksterne endringer i b√∏tter

Hvis to brukere √•pner en tjeneste med den samme team og tilgangsgruppe, s√• vil man kun se hverandres endringer i filsystemet^[Med endringer menes her at man oppretter en ny mappe] hvis begge jobber direkte mot `buckets`-filstien. Hvis en av de skriver filer med dapla-toolbelt, mens den andre bruker dapla-toolbelt eller et annet verkt√∏y, s√• vil man ikke se dette i filsystemet inne i tjenesten. Brukeren kan da kj√∏re `refresh-buckets` fra terminalen i tjenesten for √• se hva som har dukket opp. Vi anbefaler derfor alle √• bruke `buckets`-tiln√¶rmingen. 

Hvis brukeren refererer til en fil som finnes i b√∏tta, men som ikke synes i filsystemet, s√• vil det fortsatt kunne leses inn. Dette gjelder ogs√• for filer produsert av [Kildomaten](./kildomaten.qmd). Fremover kommer vi til √• tilpasse K
:::

## Milj√∏er

Det finnes 2 adskilte milj√∏er for Dapla Lab: prod og test. @tbl-env-daplalab viser hvilke url-er som gjelder for de ulike milj√∏ene.

| Milj√∏ | Url                                                            |
| ----- | -------------------------------------------------------------- |
| Prod  | <https://lab.dapla.ssb.no/>                                    |
| Test  | <https://lab.dapla-test.ssb.no/>                               |
: Oversikt over milj√∏er og tilh√∏rende url-er for Dapla Lab. {#tbl-env-daplalab .striped}

Milj√∏ene er knyttet til datatilgang for [prosjektene til Dapla-team](./hva-er-dapla-team.qmd#ressurser). Hvert Dapla-team kan ha ressurser i prod- eller test-milj√∏et. For √• f√• tilgang til ressursene i et av milj√∏ene m√• de logge seg inn p√• tilsvarende milj√∏ i Dapla Lab. Det er f.eks. ikke mulig √• aksessere prod-data fra test-milj√∏et i Dapla Lab og omvendt.

## Automatisk pausing

Hver dag **klokka 17:00** blir alle tjenester som kj√∏rer p√• Dapla pauset automatisk. Det gj√∏res for redusere ressursbruken og redusere kostnader. 

Hvis man har tjenester som trenger √• kj√∏re hele natten, s√• kan man melde tjenesten uten av pausingen ved √• gi tjenestens visningsnavn et suffix med teksten 
` [nosuspend]`, slik som vist i @fig-dapla-lab-nosuspend.

![Eksempel p√• en tjeneste som ikke blir pauset hver dag kl. 17.](../images/dapla-lab-nosuspend.png){fig-alt="Alternativtekst" #fig-dapla-lab-nosuspend}

Pausingen vil til enhver tid s√∏ke etter tjenesten som ikke har dette suffixet, og derfor kan du endre visningsnavnet n√•r som helst ved √• trykke p√• üñäÔ∏è-ikonet, for √• aktivere eller deaktivere dette.

## E-postvarsling

Hver mandag morgen blir brukere av Dapla Lab varslet p√• e-post om hvilke de tjenester de har som ble startet for mer enn **7 dager** siden. Det sendes en e-post per bruker per milj√∏. Hvis man ikke har noen tjenester som tilfredstiller kriteriene, s√• mottar man ingen e-post.

Form√•let med varslingen er √• informere brukeren om at det ikke er anbefalt √• la tjenestene leve for lenge siden det betyr at man trolig ikke kj√∏rer p√• siste versjon av tjenesten. Det betyr igjen at brukeren kan g√• glipp av viktige oppdateringer eller forbedringer som er blitt gjort.