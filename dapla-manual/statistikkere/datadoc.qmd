# Datadoc

::: {.callout-warning}
NB! Advarsel - Ustabilitet i Dapla Beta!
:::

Statistikkmetadata er strukturert informasjon om statistikk. Dette omfatter informasjon som brukes for å produsere, formidle, forstå, finne 
eller gjenbruke statistikk. For å kunne gjenfinne data i SSB er man helt avhengig av at det finnes et enhetlig system for metadata knyttet til dataene. 

## Hva er Datadoc

Datadoc er en tjeneste som skal forenkle arbeidet med å dokumentere datasett og variabelforekomster.
Felt og datatyper er definert som JSON schema i [ssb-datadoc-model](https://github.com/statisticsnorway/ssb-datadoc-model).
DataDoc har et grensesnitt bygget med [ssb-dash-components](https://pypi.org/project/ssb-dash-components/).

Foreløpig støtter løsningen følgende filformater:

1. parquet
2. sas7bdat


## Innlogging

For å starte Datadoc må du logge deg inn på Dapla Lab (**Dokumentasjon kommer**).
Start Datadoc tjenesten og du er klar til å dokumentere datasettet ditt.

## Hvordan dokumentere et datasett

### Datasett/Navnestandarden...

### Obligatorisk/anbefalt/maskingenerert...

## Lagre metadata

### Ved lagring

Når du trykker **Lagre** knappen vil du få en bekreftelse på vellykket lagring. 
![Lagre Datadoc](../images/dapla-metadata-datadoc-lagre.png){alt="Skjermbilde av tilbakemeldinger ved lagring av metadata på Datadoc"}

Hvis ikke alle obligatoriske felt er utfylt vil du få opp en advarsel for datasett og variabelforekomstene.
De manglende feltene vil vises i en liste over hvilke felt som mangler. For variabelforekomster vises både variabler og manglende felt.

Når du fyller ut de manglende obligatoriske feltene må du lagre på nytt og advarslene vil forsvinne når alle obligatoriske felt er fylt ut.

### Metadata filen

Når du trykker på **Lagre**-knappen i DataDoc så skrives alle metadata til en fil i samme mappe (katalog) som datafilen. Dette er en JSON-fil med nesten samme navn som datafilen. Navnekonvensjonen for metadatafilen er 

`<navn på datafil uten endelse>__DOC.json`

Eksempelvis hvis datafilen har navnet **skattedata_p2022_v1.parquet**, så vil DataDoc lagre metadata i filen <b>skattedata_p2022_v1__DOC.json</b>.

Fordelen med å benytte en JSON-fil til å lagre metadata er at denne filen kan kopieres og flyttes like enkelt som selve datafilen. JSON-filer er strukturerte tekstfiler som kan leses av både maskiner (Python/R) og av mennesker (åpnes i en tekst-editor).

Se et [eksempel på JSON metadata-fil](https://github.com/statisticsnorway/datadoc/blob/master/tests/resources/klargjorte_data/person_testdata_p2021-12-31_p2021-12-31_v1__DOC.json) lagret av DataDoc.



## Oppdatere eksisterende metadata

Ønsker du å endre eller legge til metadata, åpner du et datasett slik som beskrevet i [Dokumentere et datasett](./datadoc.qmd#hvordan-dokumentere-et-datasett). 
Da vil innholdet fra metadata-filen leses inn i Datadoc og kan redigeres videre. Endringene blir lagret når man trykker **Lagre**.