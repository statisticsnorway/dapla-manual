# Datadoc

::: {.callout-warning}
NB! Advarsel - Ustabilitet i Dapla Beta!
:::

Statistikkmetadata er strukturert informasjon om statistikk. Dette omfatter informasjon som brukes for å produsere, formidle, forstå, finne
eller gjenbruke statistikk. For å kunne gjenfinne data i SSB er man helt avhengig av at det finnes et enhetlig system for metadata knyttet til dataene.

## Hva er Datadoc

Datadoc er en tjeneste som skal forenkle arbeidet med å dokumentere datasett og variabelforekomster.
Felt og datatyper er definert som JSON schema i [ssb-datadoc-model](https://github.com/statisticsnorway/ssb-datadoc-model).
DataDoc har et grensesnitt bygget med [ssb-dash-components](https://pypi.org/project/ssb-dash-components/).

Foreløpig støtter løsningen følgende filformater:

1. parquet
2. sas7bdat


## Innlogging


## Hvordan dokumentere et datasett

### Åpne et datasett

Før man kan benytte Datadoc, må man åpne et Datasett. Det gjøres enkelt ved å lime inn stien til datasettet i _Filsti_ tekstboksen (Punkt 1 i @fig-aapne-datasett) og trykke på _Åpne fil_ knappen (Punkt 2 i @fig-aapne-datasett).

Datadoc benytter brukerens innloggingsopplysninger for å aksessere data. Det betyr at man i utgangspunktet har tilgang til de samme filene som ellers på Dapla.

::: {.callout-warning}
Man **må** inkludere `gs://` på begynnelsen av stien når man jobber med et datasett i en bøtte.
:::

::: {.callout-note}
Man kan finne filstien gjennom [Google konsollet](./gcc.qmd#filutforsker) eller ved å [benytte Dapla toolbelt](./jobbe-med-data.qmd#liste-ut-innhold-i-mappe)
:::

![Åpne et datasett i Datadoc.](../images/datadoc-aapne-datasett.png){fig-alt="Slik åpnes et datasett i Datadoc." width="100%" #fig-aapne-datasett}

#### Vellykket åpning

Etter at man har trykket på _Åpne fil_ knappen bør man se meldingen vist i @fig-aapne-datasett-suksess

![Meldingen at det var velykket å åpne datasettet.](../images/datadoc-aapne-datasett-suksess.png){fig-alt="Figur som viser meldingen at det var velykket åpning av datasettet." fig-align="left" width="30%" #fig-aapne-datasett-suksess}

#### Vellykket åpning med advarsel

Hvis man åpner en datasett som ikke følger navnestandarden, vil det komme en advarsel (@fig-aapne-datasett-advarsel). Det er fullt mulig å bruke Datadoc fortsatt for å dokumentere datasettet, men ikke like mye metadata kan utledes automatisk (TODO: lenke til seksjonen om utledning).

::: {.callout-note}
Dette kan være en fin anledning til å justere på navngivning og strukturen i teamets bøtter slik at alt følger [navnestandarden](./navnestandard-datalagring.qmd). Det er en lenke til navnestandarden i meldingen.
:::

![Meldingen at datasettet følger ikke navnestandarden.](../images/datadoc_warning.png){fig-alt="Figur som viser meldingen at datasettet følger ikke navnestandarden." fig-align="left" width="40%" #fig-aapne-datasett-advarsel}

### Åpne et datasett når metadatadokument eksisterer

#### Feil ved åpning

Hvis Datadoc klarer ikke åpne datasettet, så viser den en rød error melding (@fig-aapne-datasett-feil). Dette forårsakes oftest at filen ikke finnes (for eksempel på grunn av en typo i filstien), men kan også være på grunn av at man ikke har tilgang til filen, eller at det er et brudd i nettverket.

![Meldingen at det var en feil ved åpning av datasettet.](../images/datadoc-aapne-datasett-feil.png){fig-alt="Figur som viser meldingen at det var en feil ved åpning av datasettet." fig-align="left" width="40%" #fig-aapne-datasett-feil}

### Dokumentere datasett metadata

### Dokumentere variabelforekomst metadata

Dokumentasjon av variabelforekomster for et datasett kan gjøres i variabelfanen i Datadoc. 
Her vil man se en liste av alle kortnavnene til variabelforekomstene i datasettet. 
Ved å trykke seg inn på et av kortnavnene kan man dokumentere de obligatoriske og anbefalte feltene for en variabelforekomst. 

#### Arv mellom datasett og variabelforekomst fanen

For å forenkle dokumentasjonen av variabelforekomster vil noen felt arve verdiene som blir satt i datasettfanen. 
Dette gjelder følgende felter: 

- Datakilde
- Populasjon
- Temporalitetstype
- Inneholder data f.o.m 
- Inneholder data t.o.m

Det er mulig å redigere vediene i variabelforekomst fanen etter en verdi er satt i datasettfanen. 
Men hvis disse feltene blir endret i datasettfanen senere, vil de alltid overskrive det som er satt i variabelforekomst fanen. 

#### Søk i variabelforekomster

Det er mulig å søke gjennom variabelforekomstene sine kortnavn. Dette filtrerer på listen over variabelforekomster.

![Søk gjennom kortnavn til variabelforekomster](../images/dapla-metadata-datadoc-search.png){fig-alt="Figur som viser søk på variabelforekomster" fig-align="left" #fig-variable-search}

## Lagre metadata

## Oppdatere eksisterende metadata
