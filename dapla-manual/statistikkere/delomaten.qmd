---
title: Delomaten
date-modified: 10/05/2025
lightbox: true
---

::: {.callout-warning}
## Tjenesten er under utvikling

Delomaten er under utvikling og er ikke tilgjengelig for Dapla-team enda. Tjenesten vil lanseres ila høsten 2025. 
:::


Delomaten er en Dapla-tjeneste som *automatiserer sikker deling av data* mellom team med forskjellige datatilganger av hensyn til behov og personvern.

Den fungerer slik:

1. Delomaten leser data og metadata fra **produktbøtta** til det delende teamet.
2. Dataene blir **pseudonymistert eller depseudonymisert** basert på oppsettet det delende teamet har laget.
3. Resultatet lagres i en egen **Delomaten-bøtte** som kun mottaker teamet har tilgang til. 

![Team A deler data med Team B. Gjennom Delomaten vil data automatisk bli pseudonymisert/depseudonymisert og flyttet til en Delomaten-bøtte hvor kun Team B har tilgang.](../images/delomaten.png)

## Personvern og forutsetninger

Før du tar i bruk Delomaten, er det viktig at du setter deg inn i hvordan personvern håndteres i SSB.  
Delomaten er laget for å støtte trygg deling av data mellom team med ulike tilgangsnivåer og må brukes i tråd med SSBs personvernregler.

Les mer på siden [**Personvern i Dapla**](./personvern.qmd).  

## Sett opp Delomaten
For å sette opp Delomaten gjør følgende endringer i teamets IAC-repo:

1. **Sjekk at dataene er dokumentert**
   - Alle data som deles gjennom Delomaten må være dokumentert i [Datadoc](./datadoc.html).
   - Hver datafil må ha en tilhørende metadatafil (.json) som lastes opp samtidig.
   - Hvis metadatafilen mangler, vil jobben feile automatisk.

1. **Aktiver tjenesten**
   - Skru på `shared-buckets` og `Delomaten` under [Features](./features.html),  
   - eller opprett en [kundeservice-sak](https://ssb.pureservice.com/#/categories/14/new).  

2. **Opprett Delomaten-bøtte**
   - Følg veiledningen i [deling av data](./deling-av-data.qmd).  

3. **Lag konfigurasjonsfil i GitHub**
   - Opprett `automation/shared-data/<Ditt team>-prod/<>/config.yaml`.  
   - Beskriv hvilke kolonner som skal pseudonymiseres/depseudonymiseres.  

---
## Konfigurasjonsfilen

Konfigurasjonsfilen (`config.yaml`) styrer hvordan Delomaten skal behandle dataen.  
Filen må ligge i teamets IAC-repo, under `automation/shared-data/...`.

```{.yaml filename="github.com/statisticsnorway/dapla-example-iac"}
dapla-example-iac
├── automation/
│   ├── shared-data/
│   │   ├── dapla-example-prod/
│   │   │    └── altinn
│   │   │    └── ameld
│   │   └── dapla-example-test/
│   │        └── altinn
│   │        └── ameld
│   │        └── skatt
│   └── source-data/
│       ...
│...           
```

### Viktige parametre

- **`shared_bucket`**  
  Navnet på Delomaten-bøtta der resultatet lagres.  

- **`source_folder_prefix`**  
  Stien til kildedata i produktbøtta.  
  - Hvis du setter `source_folder_prefix: "forbruk/"`, betyr det at alle filer under mappen `forbruk/` i produktbøtta deles.  
  - Tips: Hvis du bare vil dele deler av mappen, kan du bruke underkataloger eller et mer spesifikt prefix.  

- **`destination_folder`**  
  Navnet på mappen i Delomaten-bøtta som mottakerne får tilgang til.  
  - Vanligvis setter du samme navn som `source_folder_prefix`, men du kan velge fritt.  

- **`memory_size`**  
  Ressurser jobben bruker (for avanserte brukere).  

- **`pseudo`**  
  En liste over kolonner som skal pseudonymiseres/depseudonymiseres, og hvilken algoritme som skal brukes.  

### Eksempel 1 – pseudonymisering
```{.yaml filename="automation/shared-data/team-a-prod/ledstill/config.yaml"}
shared_bucket: "delomatentest"
source_folder_prefix: "forbruk/"
destination_folder: "forbruk"
memory_size: 3
pseudo:
  - name: task_one
    columns: [ "fnr", "snr" ]
    pseudo_operation: "PSEUDO"
    encryption:
      algorithm: "sid_mapping"
      sid_snapshot_date: "2025-07-07"
```
Her pseudonymiseres kolonnene fnr og snr med sid mapping og katalogdato `2025-07-07`.

### Eksempel 2 – depseudonymisering
```{.yaml filename="automation/shared-data/mitt-dapla-team-prod/ledstill/config.yaml"}
shared_bucket: "delomatentest"
source_folder_prefix: "ledstill/"
destination_folder: "ledstill"
memory_size: 2
pseudo:
  - name: task_one
    columns: [ "fnr"]
    pseudo_operation: "DEPSEUDO"
    encryption:
      algorithm: "sid_mapping"
      sid_snapshot_date: "2025-07-07"
  - name: task_two
    columns: [ "fornavn"]
    pseudo_operation: "DEPSEUDO"
    encryption:
      algorithm: "default"
```
Her depseudonymiseres fnr kolonnen med sid mapping og fornavn med standardalgoritmen (DAEAD).

## Feilmeldinger

Konfigurasjonsfilen valideres automatisk når du oppretter en pull request i GitHub.
Hvis noe er feil får du en tydelig feilmelding:
![Delomaten test feil](../images/delomaten_error.png)

Eksempel på feilmelding i workflow
![Delomaten feilmelding](../images/delomaten_error_msg.png)
