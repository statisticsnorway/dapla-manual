{
  "hash": "190aadc3c63bb5d89c43ee49f91262b9",
  "result": {
    "markdown": "---\ntitle: Datadoc\nfreeze: true\nexecute:\n    echo: false\n    include: true\n\n---\n\n::: {.cell execution_count=1}\n\n::: {.cell-output .cell-output-stdout}\n```\n\n```\n:::\n:::\n\n\n![](../images/dapla-lab-datadoc-service.png){style=\"max-width: 350%; float: right;\" fig-alt=\"Jupyter Service\"}\n\nDatadoc er et tjeneste som tilbyr et grafisk grensesnitt for å dokumentere datasett og variablene som utgjør datasettet. Formålet med tjenesten er å tilby et lett-å-bruke grensesnitt som hovedsakelig vil benyttes første gang man dokumenterer en type datasett.\n\nSiden løpende statistikkproduksjon ofte innebærer at nye data legges til data fra tidligere perioder, uten at strukturen i datasett endres, så tilbys det også et annet verktøy som lar brukeren programmatisk gjenbruke metadata fra en tidligere periode. Les mer om Python-pakken [dapla-toolbelt-metadata](./dapla-toolbelt-metadata.qmd).\n\n## Forberedelser\n\nFør man starter **Datadoc-tjenesten** bør man ha lest [kapitlet om Dapla Lab](./dapla-lab.html). Deretter gjør du følgende:\n\n1. Logg deg inn på [Dapla Lab](https://lab.dapla.ssb.no/)\n2. Under **Tjenestekatalog** trykker du på **Start**-knappen for **Datadoc**\n3. Gi tjenesten et navn\n4. Åpne **Datadoc konfigurasjoner** og gjør ønskede konfigurasjoner (se neste kapittel).\n5. Trykk **Start** igjen for å åpne tjenesten. \n\nDatadoc bruker ca. 1 minutt på starte og etter det klart for dokumentere datasett. \n\n## Konfigurasjon\n\nFør man starter Datadoc bør man konfigurere tjenesten. Dette er spesielt viktig siden du bare kan representere et Dapla-team for hver Datadoc man starter. I tjenestekonfigurasjonen til Datadoc er det 2 faner: **Dapla** og **Tjeneste**.\n\n### Dapla\n\nUnder fanen **Dapla** i **Datadoc konfigurasjoner** er det en nedtrekksmeny der man kan velge **Team og tilgangsgruppe**. I nedtrekksmenyen får du listet alle team og tilgangsgrupper du er med i. Listen i nedtrekksmenyen vises på formen  **\\<daplateam\\>-\\<tilgangsgruppe\\>**. @fig-datadoc-config viser tilfellet der det er valgt å representere tilgangsgruppen **developers** i teamet **Dapla Felles**, derav **dapla-felles-developers**. Det er også det som velges som standard hvis man ikke velger noe annet. \n\n![Dapla-fanen i tjenestekonfigurasjonen for Datadoc.](../images/datadoc-config.png){fig-alt=\"Slik ser config for datadoc ut\" width=\"100%\" #fig-datadoc-config}\n\n### Tjeneste\n\nUnder fanen **Tjeneste** kan man velge versjon av tjenesten. Det vil være svært sjelden at brukere trenger å endre på noe her. Som standard åpnes alltid siste versjon av tjenesten.\n\n## Datatilgang\n\nNår man starter en Datadoc-tjeneste så må man på forhånd velge hvilket team og tilgangsgruppe man skal representere, som [forklart i forrige kapittel](./datadoc.qmd#dapla).\n\n::: {.callout-warning}\n## data-admins ikke tilgjengelig enda\n\nDet er ikke mulig å velge andre tilgangsgrupper enn **developers** for øyeblikket. Av den grunn kan man ikke bruke Datadoc til å dokumentere kildedata enda. \n:::\n\n\n\n## Funksjonalitet\n\n### Åpne datasett\n\nFør man kan benytte Datadoc, må man åpne et Datasett. Det gjøres enkelt ved å lime inn stien til datasettet i _Filsti_ tekstboksen (Punkt 1 i @fig-aapne-datasett) og trykke på _Åpne fil_ knappen (Punkt 2 i @fig-aapne-datasett).\n\nDatadoc benytter brukerens innloggingsopplysninger for å aksessere data. Det betyr at man i utgangspunktet har tilgang til de samme filene som ellers på Dapla.\n\n::: {.callout-warning}\nMan **må** inkludere `gs://` på begynnelsen av stien når man jobber med et datasett i en bøtte.\n:::\n\n::: {.callout-note}\nMan kan finne filstien gjennom [Google konsollet](./gcc.qmd#filutforsker) eller ved å [benytte Dapla toolbelt](./jobbe-med-data.qmd#liste-ut-innhold-i-mappe)\n:::\n\n![Input-feltet for å oppgi filsti i Datadoc.](../images/datadoc-open-dataset.png){fig-alt=\"Slik åpnes et datasett i Datadoc.\" width=\"100%\" #fig-aapne-datasett}\n\n#### Vellykket åpning\n\nEtter at man har trykket på _Åpne fil_ knappen bør man se meldingen vist i @fig-aapne-datasett-suksess\n\n![Meldingen at det var velykket å åpne datasettet.](../images/datadoc-aapne-datasett-suksess.png){fig-alt=\"Figur som viser meldingen at det var velykket åpning av datasettet.\" fig-align=\"left\" width=\"30%\" #fig-aapne-datasett-suksess}\n\n#### Vellykket åpning med advarsel\n\nHvis man åpner en datasett som ikke følger navnestandarden, vil det komme en advarsel (@fig-aapne-datasett-advarsel). Det er fullt mulig å bruke Datadoc fortsatt for å dokumentere datasettet, men ikke like mye metadata kan utledes automatisk (TODO: lenke til seksjonen om utledning).\n\n::: {.callout-note}\nDette kan være en fin anledning til å justere på navngivning og strukturen i teamets bøtter slik at alt følger [navnestandarden](./navnestandard.html). Det er en lenke til navnestandarden i meldingen.\n:::\n\n![Meldingen at datasettet ikke følger navnestandarden.](../images/datadoc_warning.png){fig-alt=\"Figur som viser meldingen at datasettet ikke følger navnestandarden.\" fig-align=\"left\" width=\"40%\" #fig-aapne-datasett-advarsel}\n\n#### Feil ved åpning\n\nHvis Datadoc klarer ikke åpne datasettet, vises en rød error melding (@fig-aapne-datasett-feil). Dette forårsakes oftest at filen ikke finnes (for eksempel på grunn av en typo i filstien), men kan også være på grunn av at man ikke har tilgang til filen, eller at det er et brudd i nettverket.\n\n![Meldingen at det var en feil ved åpning av datasettet.](../images/datadoc-aapne-datasett-feil.png){fig-alt=\"Figur som viser meldingen at det var en feil ved åpning av datasettet.\" fig-align=\"left\" width=\"40%\" #fig-aapne-datasett-feil}\n\n#### Åpne et datasett når metadatadokument eksisterer\n\nHvis et metadatadokument eksisterer, er det denne informasjonen som lastes inn. Det utledes ingenting fra datasettet.\n\n### Utledet informasjon\n\nInformasjon som kan utledes vil bli fylt inn når du åpner datasettet. Informasjonen hentes enten fra filstien eller settes inn som en default verdi (*). Det er mulig å korrigere informasjonen i ettertid.  Følgende felter blir forsøkt utledet:\n\nDatasett:\n\n- Verdivurdering\n- Status (*)\n- Datatilstand\n- Versjon\n- Statistikkområde\n- Inneholder data f.o.m.\n- Inneholder data t.o.m.\n- Geografisk dekningsområde (*)\n\nVariabler:\n\n- Kortnavn\n- Datatype\n\n### Dokumentere datasett-metadata\n\nDokumentasjon av datasettet som helthet gjøres i datasettfanen i Datadoc.\n\nAlle felter har en ordforklaring\n![Forklaring til feltet](../images/datadoc_ordforklaring.png){fig-alt=\"Trykk på denne for å få beskrivelse av feltet.\" fig-align=\"left\" width=\"3%\" #fig-ordforklaring}\ndu kan trykke på. Her vil du få en kort forklaring til hva som skal stå i feltet.\n\nFlere felter har verdilister hvor mange er hentet fra KLASS, mens noen er fritekstfelter. For noen av fritekstfeltene gjøres det en sjekk av innholdet og du vil få en feilmelding hvis kriteriene ikke er oppfylt.\n\n#### Obligatorisk\n\nAlt som står under obligatorisk må fylles inn.\n\n#### Anbefalt\n\nAnbefalte felter er frivillig å fylle ut.\n\n#### Maskingenerert\n\nFeltene her genereres automatisk og kan ikke redigeres. De er kun med til informasjon.\n\n### Dokumentere variabelforekomst-metadata\n\nDokumentasjon av variabelforekomster for et datasett kan gjøres i variabelfanen i Datadoc.\nHer vil man se en liste av alle kortnavnene til variabelforekomstene i datasettet.\nVed å trykke seg inn på et av kortnavnene kan man dokumentere de obligatoriske og anbefalte feltene for en variabelforekomst.\n\n#### Arv mellom datasett og variabelforekomst fanen\n\nFor å forenkle dokumentasjonen av variabelforekomster vil noen felt arve verdiene som blir satt i datasettfanen.\nDette gjelder følgende felter:\n\n- Datakilde\n- Populasjon\n- Temporalitetstype\n- Inneholder data f.o.m\n- Inneholder data t.o.m\n\nDet er mulig å redigere vediene i variabelforekomst fanen etter en verdi er satt i datasettfanen.\nMen hvis disse feltene blir endret i datasettfanen senere, vil de alltid overskrive det som er satt i variabelforekomst fanen.\n\n#### Søk i variabelforekomster\n\nDet er mulig å søke gjennom variabelforekomstene sine kortnavn. Dette filtrerer på listen over variabelforekomster.\n\n![Søk gjennom kortnavn til variabelforekomster](../images/dapla-metadata-datadoc-search.png){fig-alt=\"Figur som viser søk på variabelforekomster\" fig-align=\"left\" #fig-variable-search}\n\n### Lagre metadata\n\n::: {.callout-warning}\n## Viktig informasjon\n\nDatadoc mellomlagrer ikke utfylt metadata.\nPass på å lagre metadataene ofte ved å trykke lagre og legg merke til om du får en bekreftelse på at metadataene er lagret.\n:::\n\n#### Ved lagring\n\nNår du trykker _Lagre metadata_ knappen vil du få en bekreftelse på vellykket lagring.\n![Lagre Datadoc](../images/dapla-metadata-datadoc-lagre.png){alt=\"Skjermbilde av tilbakemeldinger ved lagring av metadata på Datadoc\"}\n\nHvis ikke alle obligatoriske felt er utfylt vil du få opp en advarsel for datasett og variabelforekomstene.\nAdvarselen for datasett viser en liste over hvilke felt som mangler. For variabelforekomster vises både variabelens kortnavn og manglende felt.\n\nNår du fyller ut de manglende obligatoriske feltene må du lagre på nytt og advarslene vil forsvinne når alle obligatoriske felt er fylt ut.\n\n#### Metadata filen\n\nNår du trykker på _Lagre metadata_ knappen i Datadoc så skrives alle metadata til en fil i samme mappe (katalog) som datafilen. Dette er en JSON-fil med nesten samme navn som datafilen. Navnekonvensjonen for metadatafilen er\n\n`<navn på datasettfilen uten endelse>__DOC.json`\n\nEksempelvis hvis datafilen har navnet `skattedata_p2022_v1.parquet`, så vil Datadoc lagre metadata i filen `skattedata_p2022_v1__DOC.json`.\n\nFordelen med å benytte en JSON-fil til å lagre metadata er at denne filen kan kopieres og flyttes like enkelt som selve datafilen. JSON-filer er strukturerte tekstfiler som kan leses av både maskiner (Python/R) og av mennesker (åpnes i en tekst-editor).\n\nSe et [eksempel på JSON metadata-fil](https://github.com/statisticsnorway/datadoc/blob/master/tests/resources/klargjorte_data/person_testdata_p2021-12-31_p2021-12-31_v1__DOC.json) lagret av DataDoc.\n\n### Modifisere metadata\n\nØnsker du å endre eller legge til metadata, åpner du et datasett slik som beskrevet i [Åpne et datasett](./datadoc.qmd#åpne-et-datasett).\nDa vil innholdet fra metadata-filen leses inn i Datadoc og kan redigeres videre. Endringene blir lagret når man trykker _Lagre metadata_.\n\n## Kildekode\n\nKildekoden til Datadoc er offentlig tilgjengelig på Github: <https://github.com/statisticsnorway/datadoc>\n\n",
    "supporting": [
      "datadoc_files"
    ],
    "filters": [],
    "includes": {}
  }
}